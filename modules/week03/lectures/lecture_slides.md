# Week 3: ì „ì´í•™ìŠµ + ë©€í‹°ëª¨ë‹¬ API í™œìš©

## ê°•ì˜ ìŠ¬ë¼ì´ë“œ

---

# ğŸ“š 3ì£¼ì°¨ í•™ìŠµ ëª©í‘œ

## ì˜¤ëŠ˜ ë°°ìš¸ ë‚´ìš©

1. **Transfer Learningì˜ ì›ë¦¬ì™€ ì‹¤ì „**
2. **Vision-Language Models ì´í•´**
3. **ë©€í‹°ëª¨ë‹¬ API í™œìš©ë²•**
4. **ìì—°ì–´ ê¸°ë°˜ ì‚¬ì§„ì²© ê²€ìƒ‰ ì•± êµ¬ì¶•**

---

# Part 1: Transfer Learning

## ğŸ¯ ì „ì´í•™ìŠµì´ë€?

### ì •ì˜
> "ì´ë¯¸ í•™ìŠµëœ ì§€ì‹ì„ ìƒˆë¡œìš´ ë¬¸ì œì— ì ìš©í•˜ëŠ” ê¸°ë²•"

### ì™œ í•„ìš”í•œê°€?
- **ë°ì´í„° ë¶€ì¡±**: ì ì€ ë°ì´í„°ë¡œë„ ë†’ì€ ì„±ëŠ¥
- **ì‹œê°„ ì ˆì•½**: ì²˜ìŒë¶€í„° í•™ìŠµ ë¶ˆí•„ìš”
- **ë¹„ìš© ì ˆê°**: GPU ì‚¬ìš© ìµœì†Œí™”
- **ì„±ëŠ¥ í–¥ìƒ**: ë” ë‚˜ì€ ì´ˆê¸° ê°€ì¤‘ì¹˜

---

## ğŸ”„ Transfer Learning ê³¼ì •

```
[ImageNet 1000 Classes]
         â†“
    [Pretrained Model]
         â†“
    [Remove Last Layer]
         â†“
    [Add Custom Layers]
         â†“
    [Your Task: 10 Classes]
```

### í•µì‹¬ ì•„ì´ë””ì–´
- í•˜ìœ„ ë ˆì´ì–´: ì¼ë°˜ì  íŠ¹ì§• (edges, textures)
- ìƒìœ„ ë ˆì´ì–´: íƒœìŠ¤í¬ íŠ¹í™” íŠ¹ì§•

---

## ğŸ“Š Feature Extraction vs Fine-tuning

### Feature Extraction
```python
# ëª¨ë“  ë ˆì´ì–´ ë™ê²°
for param in model.parameters():
    param.requires_grad = False

# ë§ˆì§€ë§‰ ë ˆì´ì–´ë§Œ êµì²´
model.fc = nn.Linear(features, num_classes)
```

**ì¥ì **: ë¹ ë¦„, ì ì€ ë°ì´í„°
**ë‹¨ì **: ì„±ëŠ¥ í•œê³„

### Fine-tuning
```python
# ì¼ë¶€/ì „ì²´ ë ˆì´ì–´ í•™ìŠµ
for param in model.parameters():
    param.requires_grad = True
```

**ì¥ì **: ìµœê³  ì„±ëŠ¥
**ë‹¨ì **: ì˜¤ë²„í”¼íŒ… ìœ„í—˜

---

## ğŸ’¡ ì–¸ì œ ë¬´ì—‡ì„ ì„ íƒí• ê¹Œ?

### Decision Tree

```
ë°ì´í„° ì–‘?
â”œâ”€ ì ìŒ (<1000)
â”‚  â””â”€ Feature Extraction
â””â”€ ë§ìŒ (>10000)
   â””â”€ ìœ ì‚¬ë„?
      â”œâ”€ ë†’ìŒ
      â”‚  â””â”€ Feature Extraction
      â””â”€ ë‚®ìŒ
         â””â”€ Fine-tuning
```

---

## ğŸš€ ì‹¤ì „ ì½”ë“œ: Transfer Learning

```python
import torch
import torchvision.models as models

# 1. ì‚¬ì „í›ˆë ¨ ëª¨ë¸ ë¡œë“œ
model = models.resnet50(pretrained=True)

# 2. Feature Extraction ì„¤ì •
for param in model.parameters():
    param.requires_grad = False

# 3. ìƒˆë¡œìš´ ë¶„ë¥˜ê¸° ì¶”ê°€
num_features = model.fc.in_features
model.fc = nn.Sequential(
    nn.Linear(num_features, 256),
    nn.ReLU(),
    nn.Dropout(0.5),
    nn.Linear(256, num_classes)
)

# 4. í•™ìŠµ
optimizer = optim.Adam(model.fc.parameters(), lr=0.001)
```

---

# Part 2: Vision-Language Models

## ğŸŒŸ CLIPì˜ í˜ì‹ 

### Contrastive Language-Image Pre-training

```
   Text Encoder          Image Encoder
        â†“                      â†“
   Text Embedding       Image Embedding
        â†“                      â†“
        â””â”€â”€â”€â”€ Similarity â”€â”€â”€â”€â”€â”˜
```

### í•µì‹¬ íŠ¹ì§•
- **4ì–µ ê°œ** ì´ë¯¸ì§€-í…ìŠ¤íŠ¸ ìŒìœ¼ë¡œ í•™ìŠµ
- **Zero-shot** ì´ë¯¸ì§€ ë¶„ë¥˜ ê°€ëŠ¥
- **ìì—°ì–´**ë¡œ ì´ë¯¸ì§€ ê²€ìƒ‰

---

## ğŸ” CLIP ì‘ë™ ì›ë¦¬

### 1. ì „ì²´ ì•„í‚¤í…ì²˜ ê°œìš”

#### CLIP ëª¨ë¸ êµ¬ì¡° ë‹¤ì´ì–´ê·¸ë¨
```
                    CLIP ì•„í‚¤í…ì²˜
                    
    ì´ë¯¸ì§€ ì…ë ¥                    í…ìŠ¤íŠ¸ ì…ë ¥
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Image  â”‚                  â”‚  Text   â”‚
    â”‚[224Ã—224]â”‚                  â”‚ "a cat" â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                             â”‚
         â–¼                             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Vision  â”‚                  â”‚  Text   â”‚
    â”‚ Encoder â”‚                  â”‚ Encoder â”‚
    â”‚(ViT/CNN)â”‚                  â”‚(BERT)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                             â”‚
         â–¼                             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Image   â”‚                  â”‚  Text   â”‚
    â”‚Features â”‚                  â”‚Features â”‚
    â”‚[512 dim]â”‚                  â”‚[512 dim]â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€ L2 Normalize â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   Shared    â”‚
            â”‚ Embedding   â”‚
            â”‚   Space     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Similarity  â”‚
            â”‚  Matrix     â”‚
            â”‚   [BÃ—B]     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ìƒì„¸ ë°ì´í„° í”Œë¡œìš°
```
ë°°ì¹˜ ì²˜ë¦¬ ê³¼ì • (ë°°ì¹˜ í¬ê¸° = 4):

ì…ë ¥:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ì´ë¯¸ì§€ ë°°ì¹˜    â”‚    â”‚   í…ìŠ¤íŠ¸ ë°°ì¹˜    â”‚
â”‚  [4, 3, 224,224]â”‚    â”‚   [4, 77]       â”‚
â”‚  ğŸ± ğŸ¶ ğŸš— ğŸ    â”‚    â”‚ "cat" "dog" "car" "house"â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚
         â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vision Encoder  â”‚    â”‚  Text Encoder   â”‚
â”‚   (ViT/ResNet)  â”‚    â”‚  (Transformer)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚
         â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Image Embedding  â”‚    â”‚ Text Embedding  â”‚
â”‚    [4, 512]     â”‚    â”‚    [4, 512]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€ L2 Normalize â”€â”€â”€â”˜
         â”‚                       â”‚
         â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Normalized Image â”‚    â”‚ Normalized Text â”‚
â”‚   Embeddings    â”‚    â”‚   Embeddings    â”‚
â”‚    [4, 512]     â”‚    â”‚    [4, 512]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€ Similarity â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Similarity Matrixâ”‚
         â”‚     [4, 4]      â”‚
         â”‚  cat dog car houseâ”‚
         â”‚ğŸ± 0.9 0.1 0.2 0.3â”‚
         â”‚ğŸ¶ 0.1 0.9 0.1 0.2â”‚
         â”‚ğŸš— 0.2 0.1 0.9 0.1â”‚
         â”‚ğŸ  0.3 0.2 0.1 0.9â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Contrastive Learning ìƒì„¸ ê³¼ì •

#### Step 1: ì„ë² ë”© ìƒì„±
```python
# ì´ë¯¸ì§€ì™€ í…ìŠ¤íŠ¸ë¥¼ ê°ê° ì¸ì½”ë”©
image_features = vision_encoder(images)  # [B, 512]
text_features = text_encoder(texts)     # [B, 512]

# L2 ì •ê·œí™” (ìœ ì‚¬ë„ ê³„ì‚°ì„ ìœ„í•´)
image_features = F.normalize(image_features, dim=-1)
text_features = F.normalize(text_features, dim=-1)
```

#### Step 2: ìœ ì‚¬ë„ í–‰ë ¬ ê³„ì‚°
```python
# ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ê³„ì‚°
logits_per_image = image_features @ text_features.T  # [B, B]
logits_per_text = text_features @ image_features.T   # [B, B]

# ì˜¨ë„ ìŠ¤ì¼€ì¼ë§ (í•™ìŠµ ì•ˆì •ì„±)
logits_per_image = logits_per_image / temperature
logits_per_text = logits_per_text / temperature
```

#### Step 3: Contrastive Loss ê³„ì‚°
```python
# ëŒ€ê°ì„ ì´ positive pairs (ë§¤ì¹­ë˜ëŠ” ì´ë¯¸ì§€-í…ìŠ¤íŠ¸ ìŒ)
labels = torch.arange(batch_size)

# ë‘ ë°©í–¥ì˜ loss ê³„ì‚°
loss_i2t = F.cross_entropy(logits_per_image, labels)
loss_t2i = F.cross_entropy(logits_per_text, labels)

# ìµœì¢… loss
total_loss = (loss_i2t + loss_t2i) / 2
```

### 3. Contrastive Learning ì‹œê°í™”

#### í•™ìŠµ ê³¼ì • ë‹¨ê³„ë³„ ì„¤ëª…
```
Step 1: ë°°ì¹˜ êµ¬ì„±
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Positive Pairs                      â”‚
â”‚  (ğŸ±, "a cat")  (ğŸ¶, "a dog")  (ğŸš—, "a car")  (ğŸ , "a house") â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 2: ì„ë² ë”© ìƒì„±
ì´ë¯¸ì§€ â†’ Vision Encoder â†’ Image Embeddings [4, 512]
í…ìŠ¤íŠ¸ â†’ Text Encoder â†’ Text Embeddings [4, 512]

Step 3: ìœ ì‚¬ë„ í–‰ë ¬ ê³„ì‚°
        "a cat" "a dog" "a car" "a house"
ğŸ±       0.9     0.1     0.2     0.3    â† Positive (ëª©í‘œ: ë†’ìŒ)
ğŸ¶       0.1     0.9     0.1     0.2    â† Positive (ëª©í‘œ: ë†’ìŒ)  
ğŸš—       0.2     0.1     0.9     0.1    â† Positive (ëª©í‘œ: ë†’ìŒ)
ğŸ        0.3     0.2     0.1     0.9    â† Positive (ëª©í‘œ: ë†’ìŒ)

Step 4: Loss ê³„ì‚°
- ëŒ€ê°ì„  ìš”ì†Œ: Positive pairs â†’ ë†’ì€ ìœ ì‚¬ë„ ìœ ë„
- ë¹„ëŒ€ê°ì„  ìš”ì†Œ: Negative pairs â†’ ë‚®ì€ ìœ ì‚¬ë„ ìœ ë„
```

#### Contrastive Loss ì‹œê°í™”
```
ë°°ì¹˜ ë‚´ Contrastive Learning:

Positive Pairs (ëŒ€ê°ì„ ):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ± â†” "a cat"    (ìœ ì‚¬ë„: 0.9) â†‘     â”‚
â”‚ ğŸ¶ â†” "a dog"    (ìœ ì‚¬ë„: 0.9) â†‘     â”‚
â”‚ ğŸš— â†” "a car"    (ìœ ì‚¬ë„: 0.9) â†‘     â”‚
â”‚ ğŸ  â†” "a house"  (ìœ ì‚¬ë„: 0.9) â†‘     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Negative Pairs (ë¹„ëŒ€ê°ì„ ):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ± â†” "a dog"    (ìœ ì‚¬ë„: 0.1) â†“     â”‚
â”‚ ğŸ± â†” "a car"    (ìœ ì‚¬ë„: 0.2) â†“     â”‚
â”‚ ğŸ¶ â†” "a cat"    (ìœ ì‚¬ë„: 0.1) â†“     â”‚
â”‚ ğŸš— â†” "a house"  (ìœ ì‚¬ë„: 0.1) â†“     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

í•™ìŠµ ëª©í‘œ:
âœ… Positive pairs: ìœ ì‚¬ë„ â†‘ (ê°€ê¹Œì´ ë°°ì¹˜)
âŒ Negative pairs: ìœ ì‚¬ë„ â†“ (ë©€ë¦¬ ë°°ì¹˜)
```

#### ì˜¨ë„ ìŠ¤ì¼€ì¼ë§ íš¨ê³¼
```
ì˜¨ë„ íŒŒë¼ë¯¸í„° (Ï„)ì˜ ì—­í• :

Ï„ = 0.07 (ê¸°ë³¸ê°’):
- ë†’ì€ ì˜¨ë„ â†’ ë¶€ë“œëŸ¬ìš´ í™•ë¥  ë¶„í¬
- ë‚®ì€ ì˜¨ë„ â†’ ë‚ ì¹´ë¡œìš´ í™•ë¥  ë¶„í¬

ìœ ì‚¬ë„ í–‰ë ¬:
ì›ë³¸: [0.8, 0.2, 0.1, 0.3]
ì˜¨ë„ ì ìš©: [0.8/0.07, 0.2/0.07, 0.1/0.07, 0.3/0.07]
        = [11.4, 2.9, 1.4, 4.3]

Softmax ì ìš©:
[0.999, 0.0003, 0.0001, 0.0006]
```

### 4. í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜

#### A. ê³µìœ  ì„ë² ë”© ê³µê°„ ì‹œê°í™”
```
                    ê³µìœ  ì„ë² ë”© ê³µê°„ (512ì°¨ì›)

í…ìŠ¤íŠ¸ ì„ë² ë”© ê³µê°„                    ì´ë¯¸ì§€ ì„ë² ë”© ê³µê°„
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ "a cat" â†’ [0.8, 0.2,   â”‚â—„â”€â”€â”€â”€â”€â”€â–ºâ”‚ [cat image] â†’ [0.79,   â”‚
â”‚          0.1, 0.0, ...]â”‚        â”‚           0.21, 0.09,  â”‚
â”‚                        â”‚        â”‚           0.01, ...]    â”‚
â”‚ "a dog" â†’ [0.1, 0.9,   â”‚â—„â”€â”€â”€â”€â”€â”€â–ºâ”‚ [dog image] â†’ [0.11,   â”‚
â”‚          0.0, 0.0, ...]â”‚        â”‚           0.89, 0.00,  â”‚
â”‚                        â”‚        â”‚           0.00, ...]    â”‚
â”‚ "a car" â†’ [0.0, 0.0,   â”‚â—„â”€â”€â”€â”€â”€â”€â–ºâ”‚ [car image] â†’ [0.01,   â”‚
â”‚          0.9, 0.1, ...]â”‚        â”‚           0.00, 0.89,  â”‚
â”‚                        â”‚        â”‚           0.10, ...]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–²                                 â–²
         â”‚                                 â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ìœ ì‚¬ë„ ê³„ì‚° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    (ì½”ì‚¬ì¸ ìœ ì‚¬ë„)

ìœ ì‚¬ë„ ì˜ˆì‹œ:
- "a cat" â†” [cat image]: 0.95 (ë§¤ìš° ë†’ìŒ)
- "a cat" â†” [dog image]: 0.12 (ë‚®ìŒ)
- "a dog" â†” [dog image]: 0.94 (ë§¤ìš° ë†’ìŒ)
```

#### B. ì„ë² ë”© ê³µê°„ì—ì„œì˜ ê±°ë¦¬ ê´€ê³„
```
2D íˆ¬ì˜ëœ ì„ë² ë”© ê³µê°„ (ì‹¤ì œë¡œëŠ” 512ì°¨ì›):

                    "a dog"
                       â—
                      / \
                     /   \
                    /     \
               "a cat"     "a car"
                   â—         â—
                  /           \
                 /             \
                /               \
           [cat image]      [car image]
               â—               â—
                \             /
                 \           /
                  \         /
                   \       /
                    \     /
                     \   /
                      \ /
                       â—
                  [dog image]

ê±°ë¦¬ ê´€ê³„:
- ê°™ì€ ì˜ë¯¸: ê°€ê¹Œìš´ ê±°ë¦¬ (ë†’ì€ ìœ ì‚¬ë„)
- ë‹¤ë¥¸ ì˜ë¯¸: ë¨¼ ê±°ë¦¬ (ë‚®ì€ ìœ ì‚¬ë„)
```

#### C. Zero-shot ë¶„ë¥˜ ê³¼ì • ìƒì„¸ ì‹œê°í™”
```
Zero-shot ë¶„ë¥˜ ê³¼ì •:

Step 1: ì…ë ¥ ì´ë¯¸ì§€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ± ì´ë¯¸ì§€   â”‚
â”‚  (224Ã—224)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vision Encoder â”‚
â”‚   (ViT/ResNet)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Image Features  â”‚
â”‚    [1, 512]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 2: ê°€ëŠ¥í•œ í´ë˜ìŠ¤ í…ìŠ¤íŠ¸ ìƒì„±
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ "a photo of a cat"                     â”‚
â”‚ "a photo of a dog"                     â”‚
â”‚ "a photo of a bird"                     â”‚
â”‚ "a photo of a car"                     â”‚
â”‚ "a photo of a house"                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Text Encoder   â”‚
â”‚  (Transformer)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Text Features   â”‚
â”‚    [5, 512]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 3: ìœ ì‚¬ë„ ê³„ì‚°
Image Features [1, 512] @ Text Features [5, 512].T = Similarities [1, 5]

ìœ ì‚¬ë„ ê²°ê³¼:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ "a photo of a cat"    â†’ 0.95 (ìµœê³ )     â”‚
â”‚ "a photo of a dog"    â†’ 0.12            â”‚
â”‚ "a photo of a bird"   â†’ 0.08            â”‚
â”‚ "a photo of a car"    â†’ 0.03            â”‚
â”‚ "a photo of a house"  â†’ 0.01            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 4: ì˜ˆì¸¡ ê²°ê³¼
ì˜ˆì¸¡ í´ë˜ìŠ¤: "a photo of a cat" (95% í™•ì‹ )
```

#### D. Zero-shot vs ì „í†µì  ë¶„ë¥˜ ë¹„êµ
```
ì „í†µì  ë¶„ë¥˜ê¸°:                    CLIP Zero-shot:

ê³ ì–‘ì´ ì´ë¯¸ì§€                    ê³ ì–‘ì´ ì´ë¯¸ì§€
     â”‚                              â”‚
     â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CNN       â”‚                â”‚  Vision     â”‚
â”‚ (ì‚¬ì „í›ˆë ¨)   â”‚                â”‚  Encoder    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                              â”‚
     â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1000ê°œ í´ë˜ìŠ¤â”‚                â”‚ Text        â”‚
â”‚ í™•ë¥  ë¶„í¬   â”‚                â”‚ Encoder     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                              â”‚
     â–¼                              â–¼
"ê³ ì–‘ì´" (95%)                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚ ì„ì˜ì˜ í…ìŠ¤íŠ¸â”‚
                              â”‚ í´ë˜ìŠ¤ ìƒì„± â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
                              "a photo of a cat" (95%)

ì¥ì :
âœ… ì‚¬ì „ ì •ì˜ëœ í´ë˜ìŠ¤ ë¶ˆí•„ìš”
âœ… ìì—°ì–´ë¡œ í´ë˜ìŠ¤ ì„¤ëª… ê°€ëŠ¥
âœ… ìƒˆë¡œìš´ ë„ë©”ì¸ì— ì¦‰ì‹œ ì ìš©
```

### 5. í•™ìŠµ ë°ì´í„°ì™€ ê·œëª¨

#### ë°ì´í„°ì…‹ êµ¬ì„± ìƒì„¸
```
WebImageText (WIT) ë°ì´í„°ì…‹:

ì´ ê·œëª¨: 400M ì´ë¯¸ì§€-í…ìŠ¤íŠ¸ ìŒ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ë°ì´í„° ì†ŒìŠ¤                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì¸í„°ë„· ì›¹ì‚¬ì´íŠ¸ (alt text)        â”‚ 200M ìŒ (50%)        â”‚
â”‚ ì†Œì…œ ë¯¸ë””ì–´ ìº¡ì…˜                   â”‚ 100M ìŒ (25%)        â”‚
â”‚ ë‰´ìŠ¤ ê¸°ì‚¬ ì´ë¯¸ì§€                   â”‚ 50M ìŒ (12.5%)       â”‚
â”‚ ìœ„í‚¤í”¼ë””ì•„ ì´ë¯¸ì§€                  â”‚ 30M ìŒ (7.5%)        â”‚
â”‚ ê¸°íƒ€ (ì˜ˆìˆ , ê³¼í•™, ê¸°ìˆ )            â”‚ 20M ìŒ (5%)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ë°ì´í„° í’ˆì§ˆ:
âœ… ìì—°ìŠ¤ëŸ¬ìš´ ìº¡ì…˜ (ì¸ê°„ì´ ì‘ì„±)
âœ… ë‹¤ì–‘í•œ ì–¸ì–´ (ì˜ì–´ ì¤‘ì‹¬, ë‹¤êµ­ì–´ í¬í•¨)
âœ… ë‹¤ì–‘í•œ ë„ë©”ì¸ (ì¼ìƒ, ì „ë¬¸, ì˜ˆìˆ , ê³¼í•™)
âœ… ê³ í•´ìƒë„ ì´ë¯¸ì§€ (ìµœì†Œ 224Ã—224)

í•™ìŠµ ë¦¬ì†ŒìŠ¤:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GPU: 256 Ã— V100 (32GB)                                 â”‚
â”‚ í•™ìŠµ ì‹œê°„: 12ì¼ (24ì‹œê°„ Ã— 12ì¼)                        â”‚
â”‚ ì´ GPU ì‹œê°„: 73,728 GPU-hours                          â”‚
â”‚ ëª¨ë¸ í¬ê¸°: 400M íŒŒë¼ë¯¸í„°                               â”‚
â”‚ ë°°ì¹˜ í¬ê¸°: 32,768                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### í•™ìŠµ ê³¼ì • ì‹œê°í™”
```
CLIP í•™ìŠµ ê³¼ì •:

Epoch 1-100: ì´ˆê¸° í•™ìŠµ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Loss: 4.5 â†’ 2.1 (ê¸‰ê²©í•œ ê°ì†Œ)                          â”‚
â”‚ ì£¼ìš” í•™ìŠµ: ê¸°ë³¸ì ì¸ ì‹œê°-ì–¸ì–´ ë§¤í•‘                      â”‚
â”‚ ì˜ˆ: "cat" â†” ê³ ì–‘ì´ ì´ë¯¸ì§€                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Epoch 101-500: ì¤‘ê°„ í•™ìŠµ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Loss: 2.1 â†’ 0.8 (ì ì§„ì  ê°ì†Œ)                          â”‚
â”‚ ì£¼ìš” í•™ìŠµ: ë³µì¡í•œ ê°œë…ê³¼ ê´€ê³„                            â”‚
â”‚ ì˜ˆ: "red car" â†” ë¹¨ê°„ ìë™ì°¨ ì´ë¯¸ì§€                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Epoch 501-1000: ê³ ê¸‰ í•™ìŠµ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Loss: 0.8 â†’ 0.3 (ë¯¸ì„¸ ì¡°ì •)                            â”‚
â”‚ ì£¼ìš” í•™ìŠµ: ì„¸ë°€í•œ êµ¬ë¶„ê³¼ ì¶”ìƒì  ê°œë…                     â”‚
â”‚ ì˜ˆ: "artistic style" â†” ì˜ˆìˆ ì  ìŠ¤íƒ€ì¼ ì´ë¯¸ì§€             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ë°°ì¹˜ êµ¬ì„± ì „ëµ
```python
# íš¨ìœ¨ì ì¸ í•™ìŠµì„ ìœ„í•œ ë°°ì¹˜ êµ¬ì„±
def create_batch(image_text_pairs):
    # Positive pairs: ë§¤ì¹­ë˜ëŠ” ì´ë¯¸ì§€-í…ìŠ¤íŠ¸
    positive_pairs = [(img, text) for img, text in image_text_pairs]
    
    # Negative pairs: ë‹¤ë¥¸ ì´ë¯¸ì§€-í…ìŠ¤íŠ¸ ì¡°í•©
    negative_pairs = []
    for i, (img, text) in enumerate(positive_pairs):
        for j, (other_img, other_text) in enumerate(positive_pairs):
            if i != j:
                negative_pairs.extend([
                    (img, other_text),      # ë‹¤ë¥¸ í…ìŠ¤íŠ¸
                    (other_img, text)       # ë‹¤ë¥¸ ì´ë¯¸ì§€
                ])
    
    return positive_pairs, negative_pairs
```

### 6. ì„±ëŠ¥ê³¼ í•œê³„ ìƒì„¸ ë¶„ì„

#### ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬ ê²°ê³¼
```
CLIP ì„±ëŠ¥ ë¹„êµ (ImageNet-1K ê¸°ì¤€):

Zero-shot ì„±ëŠ¥:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ëª¨ë¸                    â”‚ Top-1 ì •í™•ë„ â”‚ Top-5 ì •í™•ë„ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CLIP ViT-B/32          â”‚ 76.2%        â”‚ 95.0%        â”‚
â”‚ CLIP ViT-B/16          â”‚ 78.0%        â”‚ 95.4%        â”‚
â”‚ CLIP ViT-L/14          â”‚ 80.1%        â”‚ 96.0%        â”‚
â”‚ ResNet-50 (ì§€ë„í•™ìŠµ)    â”‚ 76.0%        â”‚ 93.0%        â”‚
â”‚ EfficientNet-B7        â”‚ 84.3%        â”‚ 97.1%        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

íŠ¹ì§•:
âœ… Zero-shotìœ¼ë¡œë„ ê²½ìŸë ¥ ìˆëŠ” ì„±ëŠ¥
âœ… ì‚¬ì „ í•™ìŠµ ì—†ì´ ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥
âœ… ë‹¤ì–‘í•œ ë„ë©”ì¸ì—ì„œ ì¼ê´€ëœ ì„±ëŠ¥
```

#### ê°•ì  ìƒì„¸ ë¶„ì„
```
1. Zero-shot ì„±ëŠ¥
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì¥ì : ì‚¬ì „ í•™ìŠµ ì—†ì´ë„ ë†’ì€ ì •í™•ë„                       â”‚
â”‚ ì˜ˆì‹œ: ìƒˆë¡œìš´ ë™ë¬¼ ì¢…ë¥˜ ë¶„ë¥˜                             â”‚
â”‚ "a photo of a panda" â†’ íŒë‹¤ ì´ë¯¸ì§€ (95% ì •í™•ë„)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. ë‹¤ì–‘ì„±ê³¼ ì¼ë°˜í™”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4ì–µ ê°œ ìƒ˜í”Œì˜ ê°•ë ¥í•œ ì¼ë°˜í™” ëŠ¥ë ¥                        â”‚
â”‚ ë„ë©”ì¸: ì¼ìƒ, ì˜ˆìˆ , ê³¼í•™, ê¸°ìˆ , ì˜ë£Œ ë“±                  â”‚
â”‚ ì–¸ì–´: ì˜ì–´ ì¤‘ì‹¬, ë‹¤êµ­ì–´ ì§€ì›                            â”‚
â”‚ ìŠ¤íƒ€ì¼: ì‚¬ì§„, ê·¸ë¦¼, ë§Œí™”, ìŠ¤ì¼€ì¹˜ ë“±                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. ìœ ì—°ì„±
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ìì—°ì–´ ì¿¼ë¦¬ ì˜ˆì‹œ:                                        â”‚
â”‚ "a red car in the rain"                                 â”‚
â”‚ "a person wearing a blue shirt"                          â”‚
â”‚ "a sunset over the ocean"                               â”‚
â”‚ "a cat sitting on a windowsill"                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### í•œê³„ ìƒì„¸ ë¶„ì„
```
1. ì„¸ë°€í•œ êµ¬ë¶„ì˜ ì–´ë ¤ì›€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë¬¸ì œ ìƒí™©:                                              â”‚
â”‚ - ë¹„ìŠ·í•œ í’ˆì¢…ì˜ ê°œ êµ¬ë¶„ (ê³¨ë“ ë¦¬íŠ¸ë¦¬ë²„ vs ë˜ë¸Œë¼ë„)        â”‚
â”‚ - ë¯¸ìˆ  ì‘í’ˆì˜ ì„¸ë¶€ ìŠ¤íƒ€ì¼ êµ¬ë¶„                          â”‚
â”‚ - ì˜ë£Œ ì´ë¯¸ì§€ì˜ ë¯¸ì„¸í•œ ë³‘ë³€ êµ¬ë¶„                        â”‚
â”‚                                                         â”‚
â”‚ ì›ì¸: ëŒ€ê·œëª¨ ë°ì´í„°ì˜ ì¼ë°˜í™” vs ì„¸ë°€í•œ êµ¬ë¶„ì˜ íŠ¸ë ˆì´ë“œì˜¤í”„â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. ë„ë©”ì¸ íŠ¹í™” í•œê³„
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì „ë¬¸ ë¶„ì•¼ì—ì„œì˜ í•œê³„:                                    â”‚
â”‚                                                         â”‚
â”‚ ì˜ë£Œ: X-ray, MRI, CT ìŠ¤ìº”ì˜ ì •ë°€í•œ ì§„ë‹¨                â”‚
â”‚ ê³¼í•™: ë¯¸ì„¸í•œ ì‹¤í—˜ ê²°ê³¼ ë¶„ì„                             â”‚
â”‚ ë²•ë¥ : ë¬¸ì„œì˜ ì„¸ë¶€ ì¡°í•­ í•´ì„                             â”‚
â”‚                                                         â”‚
â”‚ í•´ê²°ì±…: ë„ë©”ì¸ íŠ¹í™” fine-tuning í•„ìš”                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. í¸í–¥ì„± ë¬¸ì œ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ í•™ìŠµ ë°ì´í„° í¸í–¥:                                        â”‚
â”‚ - ì¸ì¢…, ì„±ë³„, ë‚˜ì´ í¸í–¥                                  â”‚
â”‚ - ë¬¸í™”ì  í¸í–¥ (ì„œêµ¬ ì¤‘ì‹¬)                                â”‚
â”‚ - ì–¸ì–´ í¸í–¥ (ì˜ì–´ ì¤‘ì‹¬)                                  â”‚
â”‚                                                         â”‚
â”‚ ì˜ˆì‹œ: "a doctor" â†’ ì£¼ë¡œ ë‚¨ì„± ì˜ì‚¬ ì´ë¯¸ì§€                 â”‚
â”‚       "a nurse" â†’ ì£¼ë¡œ ì—¬ì„± ê°„í˜¸ì‚¬ ì´ë¯¸ì§€               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4. ê³„ì‚° ë¹„ìš©
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë¦¬ì†ŒìŠ¤ ìš”êµ¬ì‚¬í•­:                                         â”‚
â”‚                                                         â”‚
â”‚ ì¶”ë¡ :                                                    â”‚
â”‚ - GPU ë©”ëª¨ë¦¬: 4-8GB                                      â”‚
â”‚ - ì¶”ë¡  ì‹œê°„: 100-500ms (GPU ê¸°ì¤€)                       â”‚
â”‚                                                         â”‚
â”‚ í•™ìŠµ:                                                    â”‚
â”‚ - GPU: 256 Ã— V100 (32GB)                               â”‚
â”‚ - ì‹œê°„: 12ì¼                                             â”‚
â”‚ - ë¹„ìš©: ìˆ˜ì‹­ë§Œ ë‹¬ëŸ¬                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7. ì‹¤ì „ í™œìš© ì˜ˆì‹œ

#### ì´ë¯¸ì§€ ê²€ìƒ‰ ì‹œìŠ¤í…œ
```python
class CLIPImageSearch:
    def __init__(self):
        self.model = CLIPModel.from_pretrained("openai/clip-vit-base-patch32")
        self.processor = CLIPProcessor.from_pretrained("openai/clip-vit-base-patch32")
        self.image_embeddings = None
    
    def index_images(self, image_paths):
        """ì´ë¯¸ì§€ë“¤ì„ ì¸ë±ì‹±"""
        embeddings = []
        for path in image_paths:
            image = Image.open(path)
            inputs = self.processor(images=image, return_tensors="pt")
            with torch.no_grad():
                features = self.model.get_image_features(**inputs)
                embeddings.append(features)
        
        self.image_embeddings = torch.cat(embeddings, dim=0)
    
    def search(self, query, top_k=5):
        """í…ìŠ¤íŠ¸ë¡œ ì´ë¯¸ì§€ ê²€ìƒ‰"""
        inputs = self.processor(text=query, return_tensors="pt")
        with torch.no_grad():
            text_features = self.model.get_text_features(**inputs)
        
        # ìœ ì‚¬ë„ ê³„ì‚°
        similarities = text_features @ self.image_embeddings.T
        top_indices = similarities.argsort(descending=True)[:top_k]
        
        return top_indices
```

### 8. CLIP vs ì „í†µì  ë°©ë²• ìƒì„¸ ë¹„êµ

#### ì„±ëŠ¥ ë¹„êµí‘œ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ë°©ë²•ë³„ ìƒì„¸ ë¹„êµ                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ íŠ¹ì„±              â”‚ ì „í†µì  CNN â”‚ ImageNet ë¶„ë¥˜ê¸° â”‚ CLIP                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ í•™ìŠµ ë°©ì‹          â”‚ ì§€ë„í•™ìŠµ    â”‚ ì§€ë„í•™ìŠµ         â”‚ ëŒ€ì¡°í•™ìŠµ            â”‚
â”‚ ë°ì´í„° ìš”êµ¬        â”‚ ë¼ë²¨ëœ ë°ì´í„°â”‚ 1000 í´ë˜ìŠ¤      â”‚ ì´ë¯¸ì§€-í…ìŠ¤íŠ¸ ìŒ    â”‚
â”‚ ë°ì´í„° ì–‘          â”‚ ìˆ˜ì²œ-ìˆ˜ë§Œ   â”‚ 100ë§Œ+          â”‚ 4ì–µ ìŒ             â”‚
â”‚ Zero-shot         â”‚ ë¶ˆê°€ëŠ¥      â”‚ ë¶ˆê°€ëŠ¥          â”‚ ê°€ëŠ¥               â”‚
â”‚ ìƒˆë¡œìš´ í´ë˜ìŠ¤      â”‚ ì¬í•™ìŠµ í•„ìš”  â”‚ ì¬í•™ìŠµ í•„ìš”      â”‚ ì¦‰ì‹œ ê°€ëŠ¥          â”‚
â”‚ ìì—°ì–´ ì¿¼ë¦¬        â”‚ ë¶ˆê°€ëŠ¥      â”‚ ë¶ˆê°€ëŠ¥          â”‚ ê°€ëŠ¥               â”‚
â”‚ ì„±ëŠ¥ (ImageNet)   â”‚ 76%         â”‚ 76%             â”‚ 76% (Zero-shot)    â”‚
â”‚ ìœ ì—°ì„±            â”‚ ë‚®ìŒ        â”‚ ë‚®ìŒ            â”‚ ë§¤ìš° ë†’ìŒ           â”‚
â”‚ ê³„ì‚° ë¹„ìš©         â”‚ ë‚®ìŒ        â”‚ ë‚®ìŒ            â”‚ ë†’ìŒ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤ë³„ ê¶Œì¥ ë°©ë²•
```
1. ì¼ë°˜ì ì¸ ì´ë¯¸ì§€ ë¶„ë¥˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ìƒí™©: ê³ ì–‘ì´, ê°œ, ìƒˆ ë“± ê¸°ë³¸ì ì¸ ë™ë¬¼ ë¶„ë¥˜              â”‚
â”‚                                                         â”‚
â”‚ ì „í†µì  CNN: âœ… ì í•©                                     â”‚
â”‚ - ë¹ ë¥¸ í•™ìŠµ (ìˆ˜ì‹œê°„)                                    â”‚
â”‚ - ë†’ì€ ì •í™•ë„ (95%+)                                    â”‚
â”‚ - ë‚®ì€ ë¦¬ì†ŒìŠ¤ ìš”êµ¬                                      â”‚
â”‚                                                         â”‚
â”‚ CLIP: âŒ ê³¼ë„í•œ ë¦¬ì†ŒìŠ¤                                   â”‚
â”‚ - ëŒ€ê·œëª¨ ëª¨ë¸ ë¶ˆí•„ìš”                                     â”‚
â”‚ - ë‹¨ìˆœí•œ íƒœìŠ¤í¬ì—ëŠ” ì˜¤ë²„í‚¬                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. ìƒˆë¡œìš´ ë„ë©”ì¸ ë¶„ë¥˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ìƒí™©: ì˜ë£Œ ì´ë¯¸ì§€, ìœ„ì„± ì‚¬ì§„, ì˜ˆìˆ  ì‘í’ˆ ë“±               â”‚
â”‚                                                         â”‚
â”‚ ì „í†µì  CNN: âŒ ë¶€ì í•©                                    â”‚
â”‚ - ëŒ€ëŸ‰ì˜ ë¼ë²¨ëœ ë°ì´í„° í•„ìš”                              â”‚
â”‚ - ë„ë©”ì¸ ì „ë¬¸ê°€ì˜ ë¼ë²¨ë§ í•„ìš”                            â”‚
â”‚ - ì‹œê°„ê³¼ ë¹„ìš©ì´ ë§ì´ ì†Œìš”                               â”‚
â”‚                                                         â”‚
â”‚ CLIP: âœ… ë§¤ìš° ì í•©                                      â”‚
â”‚ - Zero-shotìœ¼ë¡œ ì¦‰ì‹œ ì‚¬ìš©                               â”‚
â”‚ - ìì—°ì–´ë¡œ í´ë˜ìŠ¤ ì •ì˜ ê°€ëŠ¥                              â”‚
â”‚ - ë„ë©”ì¸ ì „ë¬¸ê°€ì˜ ì„¤ëª… í™œìš©                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. ì´ë¯¸ì§€ ê²€ìƒ‰ ì‹œìŠ¤í…œ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ìƒí™©: "ë¹¨ê°„ ìë™ì°¨", "ë°”ë‹¤ì˜ ì¼ëª°" ë“± ìì—°ì–´ ê²€ìƒ‰        â”‚
â”‚                                                         â”‚
â”‚ ì „í†µì  CNN: âŒ ë¶ˆê°€ëŠ¥                                   â”‚
â”‚ - ì‚¬ì „ ì •ì˜ëœ í´ë˜ìŠ¤ë§Œ ê°€ëŠ¥                              â”‚
â”‚ - ìì—°ì–´ ì¿¼ë¦¬ ì²˜ë¦¬ ë¶ˆê°€                                 â”‚
â”‚                                                         â”‚
â”‚ CLIP: âœ… ì™„ë²½í•œ ì í•©                                     â”‚
â”‚ - ìì—°ì–´ ì¿¼ë¦¬ ì§ì ‘ ì²˜ë¦¬                                  â”‚
â”‚ - ë³µì¡í•œ ì„¤ëª…ë„ ì´í•´ ê°€ëŠ¥                                â”‚
â”‚ - ì‹¤ì‹œê°„ ê²€ìƒ‰ ê°€ëŠ¥                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### í•˜ì´ë¸Œë¦¬ë“œ ì ‘ê·¼ë²•
```
ìµœì ì˜ ì„±ëŠ¥ì„ ìœ„í•œ í•˜ì´ë¸Œë¦¬ë“œ ì „ëµ:

1. 1ë‹¨ê³„: CLIPìœ¼ë¡œ ì´ˆê¸° í•„í„°ë§
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ "ë¹¨ê°„ ìë™ì°¨" ì¿¼ë¦¬ â†’ CLIP â†’ ê´€ë ¨ ì´ë¯¸ì§€ í›„ë³´ 1000ê°œ      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. 2ë‹¨ê³„: ì „í†µì  CNNìœ¼ë¡œ ì •ë°€ ë¶„ë¥˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ í›„ë³´ 1000ê°œ â†’ ì„¸ë°€í•œ CNN â†’ ìµœì¢… ê²°ê³¼ 10ê°œ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì¥ì :
âœ… CLIPì˜ ìœ ì—°ì„± + CNNì˜ ì •í™•ë„
âœ… ë¹ ë¥¸ ì²˜ë¦¬ ì†ë„
âœ… ë†’ì€ ì •í™•ë„
âœ… í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°
```

### ëª©í‘œ
- **Positive pairs**: ìœ ì‚¬ë„ â†‘ (ëŒ€ê°ì„  ìš”ì†Œ)
- **Negative pairs**: ìœ ì‚¬ë„ â†“ (ë¹„ëŒ€ê°ì„  ìš”ì†Œ)
- **ì¼ë°˜í™”**: ìƒˆë¡œìš´ ë„ë©”ì¸ì—ì„œë„ ë†’ì€ ì„±ëŠ¥

---

## ğŸ“ ì„ë² ë”© ê³µê°„

### Shared Embedding Space

```
    "a photo of a cat"  â†’  [0.2, 0.8, ...]
              â†“
         Similarity
              â†‘
    [Cat Image] â†’  [0.21, 0.79, ...]
```

### ì‘ìš©
- ì´ë¯¸ì§€ ê²€ìƒ‰
- Zero-shot ë¶„ë¥˜
- ì´ë¯¸ì§€ ìƒì„± ê°€ì´ë“œ

---

## ğŸ¨ CLIP í™œìš© ì˜ˆì œ

```python
from transformers import CLIPProcessor, CLIPModel

# ëª¨ë¸ ë¡œë“œ
model = CLIPModel.from_pretrained("openai/clip-vit-base-patch32")
processor = CLIPProcessor.from_pretrained("openai/clip-vit-base-patch32")

# ì´ë¯¸ì§€-í…ìŠ¤íŠ¸ ë§¤ì¹­
image = Image.open("photo.jpg")
texts = ["a cat", "a dog", "a bird"]

inputs = processor(text=texts, images=image, 
                  return_tensors="pt", padding=True)
outputs = model(**inputs)

# ìœ ì‚¬ë„ ê³„ì‚°
logits_per_image = outputs.logits_per_image
probs = logits_per_image.softmax(dim=1)
```

---

# Part 3: ë©€í‹°ëª¨ë‹¬ API í™œìš©

## ğŸ“… 2025ë…„ 9ì›” ê¸°ì¤€ API ì ‘ê·¼ ë°©ë²•

### 1. ğŸ”— OpenAI CLIP
- **ì ‘ê·¼ ë°©ì‹**: ì˜¤í”ˆì†ŒìŠ¤ ë‹¤ìš´ë¡œë“œ (API ì„œë¹„ìŠ¤ ì•„ë‹˜)
- **ì„¤ì¹˜ ë°©ë²•**:
  ```bash
  # GitHub ì§ì ‘ ì„¤ì¹˜
  pip install git+https://github.com/openai/CLIP.git
  # ë˜ëŠ” Hugging Face ë²„ì „
  pip install transformers
  ```
- **íŠ¹ì§•**: API í‚¤ ë¶ˆí•„ìš”, ë¡œì»¬ ì‹¤í–‰, ì™„ì „ ë¬´ë£Œ
- **ì‘ë‹µ ì†ë„**: <100ms (GPU ì‚¬ìš© ì‹œ)

### 2. ğŸ¤– Google Gemini API (ê¶Œì¥)
- **2025ë…„ í˜„ì¬**: Vision APIë¥¼ ëŒ€ì²´í•˜ëŠ” ì¶”ì„¸
- **ê°•ì **:
  - ë³µì¡í•œ ì´ë¯¸ì§€ ì´í•´ ë° ì¶”ë¡ 
  - ë©€í‹°ëª¨ë‹¬ ì²˜ë¦¬ (í…ìŠ¤íŠ¸, ì´ë¯¸ì§€, ë¹„ë””ì˜¤)
  - PDF ì§ì ‘ ì²˜ë¦¬ (OCR ë¶ˆí•„ìš”)
  - 90ë¶„ê¹Œì§€ ë¹„ë””ì˜¤ ì§€ì›
- **Google AI Studio ì ‘ê·¼ ë°©ë²•**:
  1. [ai.google.dev](https://ai.google.dev) ì ‘ì†
  2. Google ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
  3. "Get API key" ë²„íŠ¼ í´ë¦­
  4. "Create API key in new project" ì„ íƒ
  5. API í‚¤ ìƒì„± ì™„ë£Œ (í˜•ì‹: `AIza...`)
- **ë¬´ë£Œ í• ë‹¹ëŸ‰**: ë¶„ë‹¹ 60ê±´, ì‹ ìš©ì¹´ë“œ ë¶ˆí•„ìš”

### 3. ğŸ¤— Hugging Face API
- **í† í° ìƒì„± ë°©ë²•**:
  1. HuggingFace.co ê³„ì • ìƒì„±
  2. Settings â†’ Access Tokens
  3. "New Token" í´ë¦­
  4. ê¶Œí•œ ì„¤ì • (read/write)
  5. í† í° ìƒì„± (í˜•ì‹: `hf_xxxxx`)
- **2025ë…„ ê¶Œì¥ì‚¬í•­**:
  - í”„ë¡œë•ì…˜ì—ëŠ” fine-grained í† í° ì‚¬ìš©
  - ì•±ë³„ë¡œ ë³„ë„ í† í° ìƒì„±

---

## ğŸ”§ Gemini API ì‹¤ìŠµ

```python
import google.generativeai as genai

# API ì„¤ì •
genai.configure(api_key="YOUR_API_KEY")
model = genai.GenerativeModel('gemini-1.5-flash')

# ì´ë¯¸ì§€ ë¶„ì„
image = Image.open("photo.jpg")
response = model.generate_content([
    "Describe this image in detail",
    image
])

print(response.text)
```

### í™œìš© ì˜ˆì‹œ
- ì´ë¯¸ì§€ ìº¡ì…˜ ìƒì„±
- Visual Q&A
- OCR ë° í…ìŠ¤íŠ¸ ì¶”ì¶œ

---

---

## ğŸ“Š API ì„±ëŠ¥ ë¹„êµ

### ë²¤ì¹˜ë§ˆí¬ ê²°ê³¼

| API | ì‘ë‹µ ì‹œê°„ | ì •í™•ë„ | ë¹„ìš© |
|-----|---------|-------|------|
| Gemini | 1.2s | 95% | Free tier |
| Llama Vision | 2.1s | 92% | Free credits |
| CLIP | 0.1s | 88% | 100% Free |

### ì„ íƒ ê°€ì´ë“œ
- **ì†ë„ ì¤‘ìš”**: CLIP
- **ì •í™•ë„ ì¤‘ìš”**: Gemini
- **ì»¤ìŠ¤í„°ë§ˆì´ì§•**: Llama Vision

---

# Part 4: í†µí•© í”„ë¡œì íŠ¸

## ğŸ¯ ìì—°ì–´ ê¸°ë°˜ ì‚¬ì§„ì²© ê²€ìƒ‰ ì•±

### ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
User Query â†’ CLIP Encoder â†’ Similarity Search
                â†“
           Image Results
                â†“
          Gemini API â†’ Captions
                â†“
           Final Display
```

### í•µì‹¬ ê¸°ëŠ¥
1. í…ìŠ¤íŠ¸ë¡œ ì‚¬ì§„ ê²€ìƒ‰
2. ìœ ì‚¬ ì´ë¯¸ì§€ ì°¾ê¸°
3. ìë™ ìº¡ì…˜ ìƒì„±
4. ê³ ê¸‰ í•„í„°ë§

---

## ğŸ’» í†µí•© êµ¬í˜„

```python
class SmartPhotoAlbum:
    def __init__(self):
        # Transfer Learning ëª¨ë¸
        self.classifier = load_transfer_model()
        
        # CLIP ëª¨ë¸
        self.clip = CLIPModel.from_pretrained("openai/clip-vit-base-patch32")
        
        # Gemini API
        self.gemini = genai.GenerativeModel('gemini-1.5-flash')
    
    def search(self, query):
        # CLIPìœ¼ë¡œ ê²€ìƒ‰
        results = self.clip_search(query)
        
        # Geminië¡œ ìº¡ì…˜ ì¶”ê°€
        for result in results:
            result['caption'] = self.generate_caption(result['image'])
        
        return results
```

---

## ğŸš€ Gradio ì¸í„°í˜ì´ìŠ¤

```python
import gradio as gr

def create_app():
    with gr.Blocks() as app:
        gr.Markdown("# ğŸ–¼ï¸ Smart Photo Album")
        
        with gr.Tab("Search"):
            query = gr.Textbox(label="Search photos")
            results = gr.Gallery(label="Results")
            
            query.submit(search_photos, inputs=[query], 
                        outputs=[results])
        
        with gr.Tab("Upload"):
            upload = gr.File(label="Upload photos")
            status = gr.Textbox(label="Status")
            
            upload.change(process_upload, inputs=[upload], 
                         outputs=[status])
    
    return app

app = create_app()
app.launch()
```

---

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

### 1. ì„ë² ë”© ìºì‹±
```python
# ì‚¬ì „ ê³„ì‚° ë° ì €ì¥
embeddings = compute_embeddings(images)
np.save('embeddings.npy', embeddings)

# ë¹ ë¥¸ ë¡œë“œ
embeddings = np.load('embeddings.npy')
```

### 2. ë°°ì¹˜ ì²˜ë¦¬
```python
# í•œ ë²ˆì— ì—¬ëŸ¬ ì´ë¯¸ì§€ ì²˜ë¦¬
batch_size = 32
for i in range(0, len(images), batch_size):
    batch = images[i:i+batch_size]
    process_batch(batch)
```

### 3. ë¹„ë™ê¸° ì²˜ë¦¬
```python
import asyncio

async def process_async(images):
    tasks = [process_image(img) for img in images]
    results = await asyncio.gather(*tasks)
    return results
```

---

# ì‹¤ìŠµ ì‹œê°„

## ğŸ§ª Lab 3: í†µí•© ì‹¤ìŠµ

### Step 1: Transfer Learning
1. ResNet50ìœ¼ë¡œ ë¶„ë¥˜ê¸° ë§Œë“¤ê¸°
2. Feature Extraction vs Fine-tuning ë¹„êµ

### Step 2: CLIP ê²€ìƒ‰
1. ì´ë¯¸ì§€ ì¸ë±ì‹±
2. í…ìŠ¤íŠ¸ ê²€ìƒ‰ êµ¬í˜„

### Step 3: API í†µí•©
1. Geminië¡œ ìº¡ì…˜ ìƒì„±
2. ì„±ëŠ¥ ë¹„êµ

### Step 4: ì•± ë°°í¬
1. Gradio ì¸í„°í˜ì´ìŠ¤
2. Hugging Face Space ë°°í¬

---

## ğŸ¯ í•µì‹¬ ì •ë¦¬

### ì˜¤ëŠ˜ ë°°ìš´ ë‚´ìš©
âœ… Transfer Learningìœ¼ë¡œ íš¨ìœ¨ì ì¸ ëª¨ë¸ êµ¬ì¶•
âœ… CLIPìœ¼ë¡œ í…ìŠ¤íŠ¸-ì´ë¯¸ì§€ ê²€ìƒ‰
âœ… ë©€í‹°ëª¨ë‹¬ API í™œìš©ë²•
âœ… í†µí•© ì‹œìŠ¤í…œ êµ¬í˜„

### ë‹¤ìŒ ì£¼ ì˜ˆê³ 
- Vision Transformer (ViT)
- Self-Attention ë©”ì»¤ë‹ˆì¦˜
- DINOì™€ ìê¸°ì§€ë„í•™ìŠµ